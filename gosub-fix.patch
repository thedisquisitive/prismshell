diff --git a/src/runtime.cpp b/src/runtime.cpp
index 0000000..0000000 100644
--- a/src/runtime.cpp
+++ b/src/runtime.cpp
@@ -206,7 +206,10 @@
     } break;
 
     case Stmt::Gosub: {
-      gosubStack.push_back(*pc);
+      // return address = first line strictly greater than current
+      auto it = program.upper_bound(*pc);
+      int ret = (it == program.end()) ? std::numeric_limits<int>::max() : it->first;
+      gosubStack.push_back(ret);
       *pc = s->targetLine;
     } break;
 
